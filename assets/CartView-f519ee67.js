import{a1 as q,a2 as A,aO as S,x as N,o as f,ah as h,a6 as c,a9 as T,a8 as l,c as a,aC as m,af as g,aA as x,ag as n,aP as D,ab as t,a7 as b,ae as P,ac as R,aa as F,aQ as u,aR as I,ai as d,V as y,K as w,aS as K}from"./index-3270b4ee.js";import{V as L}from"./VContainer-a55f873c.js";import{V as E}from"./VRow-914a1202.js";const O=t("thead",null,[t("tr",null,[t("th",{style:{"font-weight":"bold","font-size":"20px",color:"#a6c9cd"}},"圖片"),t("th",{style:{"font-weight":"bold","font-size":"20px",color:"#a6c9cd"}},"名稱"),t("th",{style:{"font-weight":"bold","font-size":"20px",color:"#a6c9cd"}},"單價"),t("th",{style:{"font-weight":"bold","font-size":"20px",color:"#a6c9cd"}},"數量"),t("th",{style:{"font-weight":"bold","font-size":"20px",color:"#a6c9cd"}},"小計"),t("th",{style:{"font-weight":"bold","font-size":"20px",color:"#a6c9cd"}},"操作")])],-1),Q={key:0},U=t("td",{colspan:"6",class:"text-center"},"沒有商品",-1),$=[U],j=t("span",null,"收件人",-1),G=t("span",null,"電話",-1),H=t("span",null,"電子信箱",-1),J=t("span",null,"地址",-1),M=t("span",null,"付款方式",-1),W=t("p",{class:"text-h6",style:{"margin-bottom":"10px","text-align":"right"}},"運費: 免運",-1),X=t("p",{class:"text-h6",style:{"margin-bottom":"10px","text-align":"right"}},"總金額:",-1),Y={class:"text-h3",style:{"margin-bottom":"20px","text-align":"right"}},Z={"m-auto":""},st={__name:"CartView",setup(tt){const p=q(),_=A(),V=S(),s=N([]),v=async(o,r)=>{try{const{data:e}=await h.post("/users/cart",{product:o,quantity:r}),i=s.value.findIndex(z=>z.product._id===o);s.value[i].quantity+=r,s.value[i].quantity<=0&&s.value.splice(i,1),_.cart=e.result}catch(e){p({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}},C=f(()=>s.value.reduce((o,r)=>o+r.quantity*r.product.price,0)),k=f(()=>s.value.length>0&&!s.value.some(o=>!o.product.sell)),B=async(o,r)=>{try{await h.post("/orders",{}),_.cart=0,V.push("/orders")}catch(e){console.log(e),p({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return(async()=>{try{const{data:o}=await h.get("/users/cart");s.value.push(...o.result)}catch(o){p({text:o.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})(),(o,r)=>(c(),T(L,null,{default:l(()=>[a(E,null,{default:l(()=>[a(m,{width:"100%",style:{"margin-bottom":"50px","margin-top":"60px",border:"#a09375 1px solid","box-shadow":"none",padding:"20px"}},{default:l(()=>[a(g(x),{style:{"margin-bottom":"20px","font-weight":"bold",color:"#665D4A","text-align":"left"}},{default:l(()=>[n("購物車")]),_:1}),a(D,null,{default:l(()=>[O,t("tbody",null,[(c(!0),b(R,null,P(s.value,e=>(c(),b("tr",{key:e._id,class:K({"bg-red-lighten-5":!e.product.sell})},[t("td",null,[a(y,{src:e.product.image,cover:"",width:"100","aspect-ratio":"1"},null,8,["src"])]),t("td",null,d(e.product.name),1),t("td",null,d(e.product.price),1),t("td",null,d(e.quantity)+" ",1),t("td",null,d(e.quantity*e.product.price),1),t("td",null,[a(w,{color:"error",variant:"text",icon:"mdi-delete",onClick:i=>v(e.product._id,e.quantity*-1)},null,8,["onClick"])])],2))),128)),s.value.length===0?(c(),b("tr",Q,$)):F("",!0)])]),_:1})]),_:1}),a(m,{width:"60%",style:{"margin-right":"58.9px",border:"#a09375 1px solid","box-shadow":"none",padding:"20px","margin-bottom":"50px"}},{default:l(()=>[a(g(x),{style:{"margin-bottom":"20px","font-weight":"bold",color:"#665D4A"}},{default:l(()=>[n("選擇送貨及付款方式")]),_:1}),j,a(u,{label:"請填真實姓名",rules:o.name,"hide-details":"auto",style:{margin:"auto",border:"#a09375 1px solid","box-shadow":"none","margin-bottom":"20px"}},null,8,["rules"]),G,a(u,{label:"例如: 0912345678",rules:o.phone,"hide-details":"auto",style:{margin:"auto",border:"#a09375 1px solid","box-shadow":"none","margin-bottom":"20px"}},null,8,["rules"]),H,a(u,{label:"例如: 123@gmail.com",rules:o.email,"hide-details":"auto",style:{margin:"auto",border:"#a09375 1px solid","box-shadow":"none","margin-bottom":"20px"}},null,8,["rules"]),J,a(u,{label:"例如: 台北市中山區南京西路14號",rules:o.address,"hide-details":"auto",style:{margin:"auto",border:"#a09375 1px solid","box-shadow":"none","margin-bottom":"20px"}},null,8,["rules"]),M,a(I,{items:["711取貨付款","全家取貨付款","萊爾富取貨付款"],rules:o.payment,style:{margin:"auto",border:"#a09375 1px solid","box-shadow":"none","margin-bottom":"20px",height:"58px"}},null,8,["rules"])]),_:1}),a(m,{width:"35%",height:"617",style:{border:"#a09375 1px solid","box-shadow":"none",padding:"20px","text-align":"center"}},{default:l(()=>[a(g(x),{style:{"margin-bottom":"20px","font-weight":"bold",color:"#665D4A","text-align":"left"}},{default:l(()=>[n("訂單資訊")]),_:1}),W,X,t("p",Y,"NT. "+d(C.value),1),t("div",Z,[n("加入line官方帳號，可接收訂單資訊 "),a(y,{cols:"6",src:"https://i.imgur.com/5y5LKsA.png",width:"45%",style:{margin:"auto","margin-bottom":"20px"}})]),a(w,{color:"success",onClick:B,disabled:!k.value,width:"300px",height:"50px"},{default:l(()=>[n("結帳")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};export{st as default};
